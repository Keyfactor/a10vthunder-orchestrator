## Overview

### üîê Management Certificates

**Purpose:**  
Used to secure HTTPS access to the A10 management interface (GUI/API).

**Usage Context:**  
- AXAPI (API access over HTTPS)
- Web GUI login
- Any administrative HTTPS session

**Configured In:**  
- **GUI:** `System ‚Üí Settings ‚Üí Certificate`

**Example:**  
When a user logs into the GUI via `https://<device_ip>`, the certificate presented is the **Management Certificate**.

## Requirements


### A10 Certificate Management Orchestrator Extension

This orchestrator extension automates the process of uploading, inventorying, and deploying SSL certificates from a Linux SCP server to an A10 vThunder device. Due to A10 API limitations, certificates must be pulled from the SCP server directly by the A10 device itself.

---

#### üìå How It Works

1. **The orchestrator** connects to a Linux server via SCP to inventory available certificates.
2. It stores relevant metadata and pushes new certificates and keys to the SCP server.
3. It then instructs the **A10 device** to retrieve the certificate and private key from the Linux server using API calls.
4. The A10 device loads the certificate and key directly from the SCP server for use on its **management interface**.

---

#### üì° API Call Example (From A10 Device)

```http
POST /axapi/v3/web-service/secure/certificate
```

**Payload:**
```json
{
  "certificate": {
    "load": 1,
    "file-url": "scp://ec2-user:dda@172.31.93.107:/home/ec2-user/26125.crt"
  }
}
```

> A similar call is made for loading the private key onto the A10 device using a separate AXAPI endpoint.

- The A10 device **must have access** to the SCP server via the specified IP (`A10ToScpServerIp`).
- Ensure the certificate and key file paths are correct and accessible to the SCP user.

---

#### üîê Linux Server Requirements

##### User Access
- The SCP user (`ScpUserName`, e.g., `ec2-user`) must:
  - Have SSH/SCP access.
  - Authenticate with a password.
  - Have **read and write** permissions in the SCP location.

> New certificates and **private keys** are generated by Keyfactor and uploaded to this location by the orchestrator. Therefore, write access is essential.

##### SCP Directory Permissions
- Ensure the directory (e.g., `/home/ec2-user/`) is:
  - Writable by the orchestrator (to upload new certs/keys).
  - Readable by both the orchestrator and the A10 device (via SCP).

---

#### üîÑ Alternate Design Consideration

It may be possible to use the A10 device itself as the SCP target location if it supports read/write SCP operations **outside the CLI context**. However, A10 devices typically restrict file access through CLI or API mechanisms only, and not through standard SCP server operations. This limitation is why a separate Linux SCP server is currently required.

---

#### üîì Network and Port Requirements

| Source             | Destination         | Port | Protocol | Purpose                       |
|--------------------|---------------------|------|----------|-------------------------------|
| Orchestrator       | Linux SCP Server    | 22   | TCP      | Inventory and upload via SCP  |
| A10 Device         | Linux SCP Server    | 22   | TCP      | Cert and key retrieval via SCP|
| Orchestrator/Admin | A10 Device (API)    | 443  | HTTPS    | API calls to load certificate |

---

#### ThunderMgmt Aliases

In the ThunderMgmt store type, the **alias** determines the filename for certificates stored on the SCP server:

- **Certificate File**: `{alias}.crt` on the SCP server
- **Private Key File**: `{alias}.key` on the SCP server  
- **A10 API Reference**: The A10 management interface loads certificates using SCP URLs pointing to these files

##### Example ThunderMgmt Usage
```
Alias: "mgmt-interface-cert"
‚Üí SCP Server Files: 
  - /home/scpuser/mgmt-interface-cert.crt
  - /home/scpuser/mgmt-interface-cert.key
‚Üí A10 API Call: 
  - Certificate URL: scp://scpuser:pass@192.168.1.100:/home/scpuser/mgmt-interface-cert.crt
  - Key URL: scp://scpuser:pass@192.168.1.100:/home/scpuser/mgmt-interface-cert.key
```
##### For Alias Names  
- Use names that clearly identify the management purpose: `mgmt-interface-2025`
- Ensure filenames are valid for both SCP server filesystem and A10 API calls
- Consider including renewal dates: `mgmt-cert-jan2025`

##### ThunderMgmt File Management

The orchestrator handles file operations as follows:

1. **Add Operation**: 
   - Uploads `{alias}.crt` and `{alias}.key` to SCP server
   - Calls A10 API to load certificate from SCP URLs
   - A10 device pulls files directly from SCP server

2. **Remove Operation**:
   - Deletes `{alias}.crt` and `{alias}.key` from SCP server
   - Does not modify A10 management interface configuration

3. **Replace Operation** (with Overwrite=true):
   - Overwrites existing `{alias}.crt` and `{alias}.key` files
   - Calls A10 API to reload certificate from same SCP URLs
  
##### Character Limitations
- **Maximum Length**: 240 characters (enforced by orchestrator)
- **Recommended Characters**: Letters, numbers, hyphens, underscores
- **Avoid**: Special characters that might cause issues in API calls or file operations
  
##### ThunderMgmt Common Issues  
- **File Path Issues**: Ensure SCP user has access to the target directory
- **Invalid Filenames**: Some characters may not be valid for filesystem operations
- **URL Encoding**: Special characters in aliases may require URL encoding in SCP URLs

#### ‚úÖ Summary

This extension coordinates certificate and private key delivery by using SCP as a bridge between orchestrator logic and A10's strict API requirements. It ensures secure and automated deployment for the management interface certificates with minimal manual intervention.




